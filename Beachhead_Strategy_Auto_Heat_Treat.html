<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beachhead Strategy: Automotive Heat Treat</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

    <!-- Google Fonts: Inter for UI -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

    <!-- Markdown Parser -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        /* Dark Strategic Theme */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0F172A; /* Slate 900 */
            color: #E2E8F0; /* Slate 200 */
        }

        /* Card Styling */
        .strategy-card {
            background-color: #1E293B; /* Slate 800 */
            border: 1px solid #334155;
            border-radius: 0.5rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
        }

        /* Accent Colors */
        .accent-orange { color: #F97316; }
        .accent-blue { color: #3B82F6; }
        .accent-green { color: #10B981; }

        /* Chart Container Rules - MANDATORY */
        .chart-container {
            position: relative;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            background-color: #1E293B; /* Match card bg */
            border-radius: 0.5rem;
            padding: 1rem;
        }

        /* Responsive Heights for Charts */
        .chart-height-sm { height: 300px; max-height: 300px; }
        .chart-height-md { height: 400px; max-height: 400px; }
        .chart-height-lg { height: 500px; max-height: 500px; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0F172A; 
        }
        ::-webkit-scrollbar-thumb {
            background: #475569; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748B; 
        }
    </style>
</head>
<body class="antialiased selection:bg-orange-500 selection:text-white">

    <!-- Top Navigation / Status Bar -->
    <nav class="bg-slate-900 border-b border-slate-700 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="text-orange-500 font-extrabold text-xl tracking-tighter">STRATEGY<span class="text-white">DECK</span></span>
                    <span class="ml-4 px-3 py-1 rounded-full text-xs font-bold bg-slate-800 text-slate-400 border border-slate-700">SEGMENT: AUTO HEAT-TREAT</span>
                </div>
                <div class="flex items-center space-x-4 text-xs font-medium text-slate-400">
                    <span class="hidden md:inline">REGION: NORTH AMERICA</span>
                    <span class="w-px h-4 bg-slate-700"></span>
                    <span class="text-green-400">STATUS: HIGH PRIORITY</span>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8 space-y-12">

        <!-- Hero: The Strategic Opportunity -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <div>
                <h6 class="text-orange-500 font-bold uppercase tracking-widest mb-2">Beachhead Entry Point</h6>
                <h1 class="text-4xl md:text-5xl font-extrabold text-white leading-tight mb-6">
                    Commercial Carburizing Shops
                </h1>
                <p class="text-lg text-slate-400 mb-8 leading-relaxed">
                    <strong>The Target:</strong> 350+ independent facilities in the "Rust Belt" running continuous gas carburizing furnaces. 
                    <br><br>
                    <strong>The Trigger:</strong> These shops are squeezed between rising <strong>CQI-9 quality mandates</strong> from automakers and the failing reliability of 1990s-era Endogas generators. They need a "Utility-Grade" CO solution to survive.
                </p>
                
                <div class="grid grid-cols-3 gap-4 border-t border-slate-700 pt-6">
                    <div>
                        <span class="block text-3xl font-bold text-white">400k</span>
                        <span class="text-xs text-slate-500 uppercase">Tons CO Demand / Yr</span>
                    </div>
                    <div>
                        <span class="block text-3xl font-bold text-orange-500">Fast</span>
                        <span class="text-xs text-slate-500 uppercase">Sales Cycle (3-6mo)</span>
                    </div>
                    <div>
                        <span class="block text-3xl font-bold text-blue-500">High</span>
                        <span class="text-xs text-slate-500 uppercase">Pain Intensity</span>
                    </div>
                </div>
            </div>

            <!-- Market Cluster Map (Bubble Chart Proxy) -->
            <div class="chart-container chart-height-md bg-slate-800 border border-slate-700">
                <canvas id="marketClusterChart"></canvas>
            </div>
        </section>

        <!-- Technical Deep Dive: The Endogas Problem -->
        <section>
            <div class="flex items-end justify-between mb-6 border-b border-slate-700 pb-4">
                <div>
                    <h2 class="text-2xl font-bold text-white">The "Endogas" Volatility Trap</h2>
                    <p class="text-slate-400 mt-1">Why legacy generators are failing modern automotive standards.</p>
                </div>
                <div class="hidden md:block text-right">
                    <div class="text-xs text-slate-500 uppercase">Critical Metric</div>
                    <div class="font-mono text-orange-400 font-bold">Carbon Potential (Cp) Stability</div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Chart: Stability Simulation -->
                <div class="lg:col-span-2 chart-container chart-height-md">
                    <canvas id="stabilityLineChart"></canvas>
                </div>

                <!-- Technical Context -->
                <div class="space-y-4">
                    <div class="strategy-card border-l-4 border-red-500">
                        <h4 class="font-bold text-white mb-2">The "Drift" Risk</h4>
                        <p class="text-sm text-slate-400">
                            Legacy generators rely on precise Air/Gas ratios. Weather changes or catalyst age cause "drift."
                            <br><br>
                            <span class="text-red-400 font-bold">Consequence:</span> A 0.05% shift in Carbon Potential can cause <strong>Intergranular Oxidation (IGO)</strong> in gears, leading to immediate batch rejection by OEMs.
                        </p>
                    </div>
                    <div class="strategy-card border-l-4 border-green-500">
                        <h4 class="font-bold text-white mb-2">The Pure CO Fix</h4>
                        <p class="text-sm text-slate-400">
                            Direct injection of pure CO eliminates the generator variable entirely. Chemistry is controlled via flow meters, not combustion.
                            <br><br>
                            <span class="text-green-400 font-bold">Result:</span> Flatline stability, zero soot, and instant response to furnace demand.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Economic Analysis: Total Cost of Ownership -->
        <section class="bg-slate-800 rounded-xl p-8 border border-slate-700">
            <h2 class="text-2xl font-bold text-white mb-8 text-center">Operational Economics: Beyond Gas Price</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                <!-- TCO Chart -->
                <div class="chart-container chart-height-md">
                    <canvas id="tcoChart"></canvas>
                </div>

                <!-- Financial Breakdown -->
                <div class="space-y-6">
                    <div>
                        <h3 class="text-xl font-bold text-white mb-2">The "Hidden" Costs of Endogas</h3>
                        <p class="text-slate-400">
                            Heat treaters often only calculate the natural gas cost to run the generator (~$0.20/m³). They ignore the massive operational overhead.
                        </p>
                    </div>

                    <ul class="space-y-4">
                        <li class="flex items-start">
                            <span class="flex-shrink-0 h-6 w-6 rounded bg-red-900 text-red-400 flex items-center justify-center font-bold text-xs mt-0.5">1</span>
                            <div class="ml-4">
                                <strong class="block text-white">Maintenance Labor (The Burnout)</strong>
                                <span class="text-sm text-slate-400">Generators need weekly "burnouts" to clear soot. This costs ~8 hours of downtime/labor per week.</span>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="flex-shrink-0 h-6 w-6 rounded bg-red-900 text-red-400 flex items-center justify-center font-bold text-xs mt-0.5">2</span>
                            <div class="ml-4">
                                <strong class="block text-white">Scrap & Rework</strong>
                                <span class="text-sm text-slate-400">A single "soot event" can ruin a basket of gears worth $50,000. Reducing scrap by 0.5% pays for the entire gas bill.</span>
                            </div>
                        </li>
                        <li class="flex items-start">
                            <span class="flex-shrink-0 h-6 w-6 rounded bg-green-900 text-green-400 flex items-center justify-center font-bold text-xs mt-0.5">3</span>
                            <div class="ml-4">
                                <strong class="block text-white">The On-Site CO Advantage</strong>
                                <span class="text-sm text-slate-400">Stable pricing. No generator maintenance. Reduced electricity (Endogenerators are energy hogs).</span>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Strategic Fit & Compliance -->
        <section>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Radar Chart: Operational Score -->
                <div class="lg:col-span-1 chart-container chart-height-sm">
                    <canvas id="complianceRadarChart"></canvas>
                </div>

                <!-- Compliance Card -->
                <div class="strategy-card lg:col-span-2 flex flex-col justify-center">
                    <h3 class="text-xl font-bold text-white mb-4">The Compliance Weapon: CQI-9</h3>
                    <p class="text-slate-400 mb-6">
                        The <strong>Automotive Industry Action Group (AIAG)</strong> mandates the CQI-9 standard. It requires rigorous atmosphere monitoring and process capability ($C_{pk}$).
                    </p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div class="bg-slate-900 p-4 rounded border border-slate-700">
                            <div class="text-orange-500 font-bold mb-1">Old Way (Endogas)</div>
                            <p class="text-xs text-slate-500">"We hope the generator didn't drift last night." Reactive adjustments based on shim stock tests.</p>
                        </div>
                        <div class="bg-slate-900 p-4 rounded border border-slate-700">
                            <div class="text-green-500 font-bold mb-1">New Way (Pure CO)</div>
                            <p class="text-xs text-slate-500">"Set it and forget it." Digital flow control guarantees partial pressure. 100% Traceability for audits.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI Scenario Planner -->
        <section class="border-t border-slate-700 pt-10">
            <div class="flex items-center gap-3 mb-6">
                <div class="bg-orange-600 text-white p-2 rounded-lg">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-white">Beachhead Scenario Planner</h2>
                    <p class="text-sm text-slate-400">Simulate the switch from Endogas to On-Site CO.</p>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Inputs -->
                <div class="strategy-card space-y-5">
                    <div>
                        <label class="block text-xs font-bold text-slate-400 uppercase mb-2">Current Furnaces</label>
                        <input type="range" id="furnaceInput" min="1" max="15" step="1" value="5" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-orange-500" oninput="document.getElementById('furnaceValue').innerText = this.value">
                        <div class="text-right text-orange-500 font-mono font-bold" id="furnaceValue">5</div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-400 uppercase mb-2">Weekly Downtime (Hours)</label>
                        <input type="range" id="downtimeInput" min="0" max="20" step="1" value="6" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-orange-500" oninput="document.getElementById('downtimeValue').innerText = this.value + ' hrs'">
                        <div class="text-right text-orange-500 font-mono font-bold" id="downtimeValue">6 hrs</div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-400 uppercase mb-2">Scrap Rate (%)</label>
                        <select id="scrapInput" class="w-full bg-slate-900 border border-slate-700 text-white rounded p-2 text-sm focus:ring-orange-500 focus:border-orange-500">
                            <option value="0.5">Low (0.5%)</option>
                            <option value="1.5" selected>Average (1.5%)</option>
                            <option value="3.0">Crisis (3.0%)</option>
                        </select>
                    </div>

                    <button onclick="generateBusinessCase()" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-4 rounded transition duration-200">
                        Generate Business Case
                    </button>
                </div>

                <!-- AI Output -->
                <div class="lg:col-span-2 strategy-card min-h-[250px] flex flex-col relative">
                    <div id="aiLoading" class="hidden absolute inset-0 bg-slate-800/90 flex items-center justify-center z-10">
                        <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"></div>
                    </div>
                    
                    <div id="aiPlaceholder" class="flex-1 flex flex-col items-center justify-center text-slate-600 text-center">
                        <p>Awaiting inputs...</p>
                    </div>

                    <div id="aiResult" class="hidden prose prose-invert prose-sm max-w-none">
                        <!-- Content -->
                    </div>
                </div>
            </div>
        </section>
        
        <footer class="text-center text-slate-600 text-xs py-12">
            Strategic Analysis: Automotive Heat Treat Beachhead • 2025
        </footer>

    </main>

    <!-- JavaScript for Logic -->
    <script>
        // --- CHART 1: Market Clusters (Bubble Chart) ---
        const ctxCluster = document.getElementById('marketClusterChart').getContext('2d');
        new Chart(ctxCluster, {
            type: 'bubble',
            data: {
                datasets: [
                    {
                        label: 'Detroit Metro (MI)',
                        data: [{x: 85, y: 90, r: 25}], // High Density, High Volume
                        backgroundColor: 'rgba(249, 115, 22, 0.8)', // Orange
                        borderColor: '#fff',
                        borderWidth: 1
                    },
                    {
                        label: 'Cleveland/Ohio Valley',
                        data: [{x: 75, y: 80, r: 20}],
                        backgroundColor: 'rgba(59, 130, 246, 0.8)', // Blue
                        borderColor: '#fff',
                        borderWidth: 1
                    },
                    {
                        label: 'Chicago/Midwest',
                        data: [{x: 65, y: 70, r: 18}],
                        backgroundColor: 'rgba(16, 185, 129, 0.8)', // Green
                        borderColor: '#fff',
                        borderWidth: 1
                    },
                    {
                        label: 'Southern Auto Corridor',
                        data: [{x: 40, y: 50, r: 15}],
                        backgroundColor: 'rgba(139, 92, 246, 0.8)', // Purple
                        borderColor: '#fff',
                        borderWidth: 1
                    },
                    {
                        label: 'Mexico Border (Maquiladoras)',
                        data: [{x: 30, y: 40, r: 12}],
                        backgroundColor: 'rgba(236, 72, 153, 0.8)', // Pink
                        borderColor: '#fff',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        title: { display: true, text: 'Automotive Supplier Density', color: '#94a3b8' },
                        grid: { color: '#334155' },
                        ticks: { display: false } // Abstract scale
                    },
                    y: {
                        title: { display: true, text: 'Heat Treat Volume demand', color: '#94a3b8' },
                        grid: { color: '#334155' },
                        ticks: { display: false }
                    }
                },
                plugins: {
                    legend: { labels: { color: '#e2e8f0' } },
                    title: { display: true, text: 'Target Clusters: Volume vs. Density', color: 'white' }
                }
            }
        });

        // --- CHART 2: Stability Line Chart ---
        const ctxStability = document.getElementById('stabilityLineChart').getContext('2d');
        // Generate mock data: Endogas (noisy) vs Pure CO (stable)
        const labels = Array.from({length: 24}, (_, i) => `${i}:00`);
        const endogasData = labels.map(() => 0.90 + (Math.random() * 0.15 - 0.075)); // Hover around 0.90 but noisy
        const pureCoData = labels.map(() => 0.90); // Flatline

        // Add a "Soot Event" dip for Endogas
        endogasData[15] = 1.2; // Spike
        endogasData[16] = 1.3; // Spike (Sooting)
        endogasData[17] = 0.7; // Crash (Correction)

        new Chart(ctxStability, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Legacy Endogas (Generator)',
                        data: endogasData,
                        borderColor: '#ef4444', // Red
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        pointRadius: 0
                    },
                    {
                        label: 'On-Site Pure CO',
                        data: pureCoData,
                        borderColor: '#10b981', // Green
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        pointRadius: 0
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        title: { display: true, text: 'Carbon Potential (% C)', color: '#94a3b8' },
                        grid: { color: '#334155' },
                        ticks: { color: '#94a3b8' },
                        min: 0.5,
                        max: 1.5
                    },
                    x: {
                        title: { display: true, text: '24 Hour Operational Cycle', color: '#94a3b8' },
                        grid: { display: false },
                        ticks: { color: '#94a3b8', maxTicksLimit: 6 }
                    }
                },
                plugins: {
                    legend: { labels: { color: '#e2e8f0' } },
                    annotation: {
                        // Ideally we'd use chartjs-plugin-annotation, but for vanilla Chart.js we skip complexity
                    }
                }
            }
        });

        // --- CHART 3: TCO Stacked Bar ---
        const ctxTco = document.getElementById('tcoChart').getContext('2d');
        new Chart(ctxTco, {
            type: 'bar',
            data: {
                labels: ['Legacy Endogas', 'On-Site Pure CO'],
                datasets: [
                    {
                        label: 'Gas/Feedstock Cost',
                        data: [40, 55], // Endogas gas is cheap, Pure CO feedstock slightly higher or similar
                        backgroundColor: '#3b82f6' // Blue
                    },
                    {
                        label: 'Electricity',
                        data: [25, 10], // Generators use huge heaters
                        backgroundColor: '#6366f1' // Indigo
                    },
                    {
                        label: 'Maintenance & Spares',
                        data: [20, 2], // Rebuilds, catalysts vs minimal
                        backgroundColor: '#f59e0b' // Amber
                    },
                    {
                        label: 'Scrap/Rework Cost',
                        data: [15, 1], // The hidden killer
                        backgroundColor: '#ef4444' // Red
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { stacked: true, grid: { display: false }, ticks: { color: 'white' } },
                    y: { stacked: true, display: false }
                },
                plugins: {
                    legend: { position: 'bottom', labels: { color: '#cbd5e1' } },
                    title: { display: true, text: 'Total Cost of Operation (Indexed)', color: 'white' }
                }
            }
        });

        // --- CHART 4: Compliance Radar ---
        const ctxCompliance = document.getElementById('complianceRadarChart').getContext('2d');
        new Chart(ctxCompliance, {
            type: 'radar',
            data: {
                labels: ['Process Stability (Cpk)', 'Audit Traceability', 'Safety (H2 Risk)', 'Uptime', 'Cost Predictability'],
                datasets: [
                    {
                        label: 'Endogas',
                        data: [5, 4, 4, 6, 5],
                        borderColor: '#64748b', // Slate
                        backgroundColor: 'rgba(100, 116, 139, 0.2)',
                    },
                    {
                        label: 'Pure CO System',
                        data: [10, 10, 9, 9, 8],
                        borderColor: '#f97316', // Orange
                        backgroundColor: 'rgba(249, 115, 22, 0.2)',
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        grid: { color: '#334155' },
                        angleLines: { color: '#334155' },
                        pointLabels: { color: '#cbd5e1', font: {size: 11} },
                        ticks: { display: false, backdropColor: 'transparent' }
                    }
                },
                plugins: {
                    legend: { labels: { color: '#e2e8f0' } }
                }
            }
        });

        // --- GEMINI API INTEGRATION ---
        async function generateBusinessCase() {
            const apiKey = ""; // API key provided by environment
            const furnaces = document.getElementById('furnaceInput').value;
            const downtime = document.getElementById('downtimeInput').value;
            const scrap = document.getElementById('scrapInput').options[document.getElementById('scrapInput').selectedIndex].text;

            const placeholder = document.getElementById('aiPlaceholder');
            const loading = document.getElementById('aiLoading');
            const result = document.getElementById('aiResult');

            placeholder.classList.add('hidden');
            result.classList.add('hidden');
            loading.classList.remove('hidden');

            const prompt = `Act as a Technical Sales Engineer for an industrial gas company. 
            Write a persuasive "Business Case Snapshot" for a Heat Treat Plant Manager.
            
            The Plant:
            - ${furnaces} Carburizing Furnaces
            - Suffering ${downtime} hours/week of generator-related downtime.
            - Current Scrap Rate: ${scrap}.
            
            The Solution: Switching from Endogas Generators to On-Site Pure CO.
            
            Output Structure:
            1. **The Hidden Bleed:** Estimate the annual cost of that downtime (assume $500/hr operating cost).
            2. **Quality Impact:** How Pure CO fixes the specific scrap issue (mention Intergranular Oxidation).
            3. **The "Killer" Stat:** One sentence summary of ROI.
            
            Tone: Professional, direct, industrial. Use bolding for numbers.`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });

                const data = await response.json();
                const text = data.candidates[0].content.parts[0].text;
                
                result.innerHTML = marked.parse(text);
                loading.classList.add('hidden');
                result.classList.remove('hidden');

            } catch (error) {
                console.error(error);
                loading.classList.add('hidden');
                result.innerHTML = '<p class="text-red-500">Analysis failed. Please try again.</p>';
                result.classList.remove('hidden');
            }
        }
    </script>
</body>
</html>